<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ—Å–ø—É–±–ª–∏–∫–∞–ª—ã“õ –ú–µ–∫—Ç–µ–ø –û–ª–∏–º–ø–∏–∞–¥–∞–ª–∞—Ä—ã</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* –°–¢–ò–õ–¨–î–ï–† (–±“±—Ä—ã–Ω“ì—ã –∫–æ–¥—Ç—ã“£ –±–∞—Ä–ª—ã“õ —Å—Ç–∏–ª—å –±”©–ª—ñ–º—ñ–Ω —Å–∞“õ—Ç–∞“£—ã–∑ - ”©–∑–≥–µ—Ä—ñ—Å—Å—ñ–∑ “õ–∞–ª–¥—ã—Ä—ã“£—ã–∑) */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #2980b9;
            --accent-color: #27ae60;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* ... –±–∞—Ä–ª—ã“õ —Å—Ç–∏–ª—å–¥–µ—Ä (–∂–æ“ì–∞—Ä—ã–¥–∞“ì—ã –∫–æ–¥—Ç—ã“£ –±“Ø–∫—ñ–ª —Å—Ç–∏–ª—å –±”©–ª—ñ–º—ñ–Ω –æ—Å—ã –∂–µ—Ä–≥–µ “õ–æ–π—ã“£—ã–∑) ... */

        /* –ñ–ê“¢–ê –°–¢–ò–õ–¨–î–ï–†: –ì—Ä–∞—Ñ–∏–∫—Ç–µ—Ä “Ø—à—ñ–Ω */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            margin: 20px 0;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è–ª–∞—Ä */
        @keyframes slideInRight {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .slide-in-right {
            animation: slideInRight 0.5s ease forwards;
        }

        /* –ñ“Ø–∫—Ç–µ—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(41, 128, 185, 0.3);
            border-radius: 50%;
            border-top-color: var(--secondary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* –ò–µ—Ä–∞—Ä—Ö–∏—è–ª—ã“õ –∫–∞—Ä—Ç–æ—á–∫–∞–ª–∞—Ä */
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        body.dark-mode .card {
            background-color: #1a1a2e;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        /* –°“±—Ä—ã–ø—Ç–∞—É –ø–∞–Ω–µ–ª—ñ */
        .sort-panel {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .sort-btn {
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        body.dark-mode .sort-btn {
            background-color: #2d3748;
            color: #e6e6e6;
            border-color: #4a5568;
        }

        .sort-btn.active {
            background: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        /* –†–µ–π—Ç–∏–Ω–≥ –∫–µ—Å—Ç–µ—Å—ñ */
        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .ranking-table th, .ranking-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        body.dark-mode .ranking-table th,
        body.dark-mode .ranking-table td {
            border-color: #4a5568;
        }

        .ranking-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: var(--primary-color);
        }

        body.dark-mode .ranking-table th {
            background-color: #2d3748;
        }

        .ranking-table tr:hover {
            background-color: #f5f5f5;
        }

        body.dark-mode .ranking-table tr:hover {
            background-color: rgba(255,255,255,0.05);
        }

        .medal {
            display: inline-block;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            font-weight: bold;
            margin-right: 10px;
        }

        .gold { background: gold; color: #333; }
        .silver { background: silver; color: #333; }
        .bronze { background: #cd7f32; color: white; }

        /* “ö“±–ø–∏—è —Å”©–∑–¥—ñ –±–∞—Å“õ–∞—Ä—É */
        .password-protected {
            position: relative;
        }

        .password-input {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        body.dark-mode .password-input {
            background-color: #2d3748;
        }

        .password-input input {
            width: 200px;
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .incorrect-password {
            color: #e74c3c;
            margin-top: 10px;
            display: none;
        }

        /* –ú–æ–±–∏–ª—å–¥—ñ –∞–¥–∞–ø—Ç–∏–≤—Ç—ñ–ª—ñ–∫ */
        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 20px;
            }
            
            nav a {
                margin: 0 5px;
                padding: 5px 10px;
                font-size: 0.9rem;
            }
            
            .event-details {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
            
            .telegram-banner {
                padding: 20px 15px;
            }
            
            .filter-buttons, .sort-panel {
                justify-content: center;
            }
            
            .logo {
                font-size: 1.8rem;
            }
            
            .event-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .event-date {
                align-self: flex-start;
            }
            
            .ranking-table {
                font-size: 0.9rem;
            }
            
            .ranking-table th, .ranking-table td {
                padding: 8px 10px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            nav {
                padding: 10px;
            }
            
            nav a {
                margin: 0 3px;
                padding: 4px 8px;
                font-size: 0.8rem;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: center;
            }
            
            .sort-panel {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="animate__animated animate__fadeIn">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-trophy"></i>
                <span>–ú–µ–∫—Ç–µ–ø –û–ª–∏–º–ø–∏–∞–¥–∞–ª–∞—Ä—ã –º–µ–Ω —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä—ã</span>
            </div>
            <p>–ë—ñ–ª—ñ–º–¥—ñ –∂–∞“£–∞ –¥–µ“£–≥–µ–π–≥–µ –∫”©—Ç–µ—Ä—ñ“£—ñ–∑!</p>
            <div class="live-stats">
                <span id="live-participants">0</span> “õ–∞—Ç—ã—Å—É—à—ã –æ–Ω–ª–∞–π–Ω
                <span id="current-time" style="margin-left: 20px;"></span>
            </div>
        </div>
    </header>
    
    <nav>
        <a href="#events" class="active"><i class="fas fa-calendar-alt"></i> –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä</a>
        <a href="#add-event"><i class="fas fa-plus-circle"></i> –Ü—Å-—à–∞—Ä–∞ “õ–æ—Å—É</a>
        <a href="#admin"><i class="fas fa-user-shield"></i> ”ò–∫—ñ–º—à—ñ–ª—ñ–∫</a>
        <a href="#results"><i class="fas fa-chart-line"></i> –ù”ô—Ç–∏–∂–µ–ª–µ—Ä</a>
        <a href="#contact"><i class="fas fa-envelope"></i> –ë–∞–π–ª–∞–Ω—ã—Å</a>
        <a href="#notifications" id="notification-btn">
            <i class="fas fa-bell"></i> –•–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä
            <span class="notification-badge" id="notificationCount">3</span>
        </a>
    </nav>
    
    <div class="container animate__animated animate__fadeInUp" id="events">
        <h2><i class="fas fa-calendar-check"></i> –ê“ì—ã–º–¥–∞“ì—ã –û–ª–∏–º–ø–∏–∞–¥–∞–ª–∞—Ä</h2>
        
        <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all">–ë–∞—Ä–ª—ã“ì—ã</button>
            <button class="filter-btn" data-filter="olympiad">–û–ª–∏–º–ø–∏–∞–¥–∞–ª–∞—Ä</button>
            <button class="filter-btn" data-filter="competition">–ö–æ–Ω–∫—É—Ä—Å—Ç–∞—Ä</button>
            <button class="filter-btn" data-filter="urgent">–ñ–µ–¥–µ–ª</button>
            <button class="filter-btn" data-filter="upcoming">–ê–ª–¥–∞“ì—ã</button>
            <button class="filter-btn" data-filter="ongoing">–ñ“Ø—Ä–≥—ñ–∑—ñ–ª—É–¥–µ</button>
        </div>
        
        <div class="sort-panel">
            <button class="sort-btn active" data-sort="date-asc">–ö“Ø–Ω—ñ –±–æ–π—ã–Ω—à–∞ (–µ“£ –∂–∞“õ—ã–Ω)</button>
            <button class="sort-btn" data-sort="date-desc">–ö“Ø–Ω—ñ –±–æ–π—ã–Ω—à–∞ (–µ“£ –∞–ª—ã—Å)</button>
            <button class="sort-btn" data-sort="name-asc">–ê—Ç–∞—É—ã –±–æ–π—ã–Ω—à–∞ (–ê-–Ø)</button>
            <button class="sort-btn" data-sort="participants-desc">“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä —Å–∞–Ω—ã</button>
        </div>
        
        <div class="stats-cards">
            <div class="stat-card">
                <i class="fas fa-calendar-day"></i>
                <div class="number" id="total-events">0</div>
                <div class="label">–Ü—Å-—à–∞—Ä–∞–ª–∞—Ä —Å–∞–Ω—ã</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <div class="number" id="total-participants">0</div>
                <div class="label">–¢—ñ—Ä–∫–µ–ª–≥–µ–Ω “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-school"></i>
                <div class="number" id="total-schools">0</div>
                <div class="label">–ú–µ–∫—Ç–µ–ø—Ç–µ—Ä —Å–∞–Ω—ã</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-clock"></i>
                <div class="number" id="upcoming-events">0</div>
                <div class="label">–ê–ª–¥–∞“ì—ã —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä</div>
            </div>
        </div>
        
        <div id="events-list">
            <!-- –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä –¥–∏–Ω–∞–º–∏–∫–∞–ª—ã“õ —Ç“Ø—Ä–¥–µ –æ—Å—ã–Ω–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã -->
        </div>
    </div>
    
    <div class="container animate__animated animate__fadeInUp" id="add-event">
        <h2><i class="fas fa-plus-square"></i> –ñ–∞“£–∞ –Ü—Å-—à–∞—Ä–∞ “ö–æ—Å—É</h2>
        <button class="add-event-btn" id="toggleFormBtn">
            <i class="fas fa-plus"></i> –Ü—Å-—à–∞—Ä–∞ “õ–æ—Å—É —Ñ–æ—Ä–º–∞—Å—ã–Ω –∞—à—É
        </button>
        
        <div class="form-container" id="eventForm">
            <form id="newEventForm">
                <h3>–Ü—Å-—à–∞—Ä–∞ –∞“õ–ø–∞—Ä–∞—Ç—ã</h3>
                <input type="text" id="eventName" placeholder="–Ü—Å-—à–∞—Ä–∞ –∞—Ç–∞—É—ã *" required>
                <input type="date" id="eventDate" required>
                <input type="text" id="eventLocation" placeholder="–û—Ä—ã–Ω *" required>
                <input type="number" id="eventCapacity" placeholder="“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä —Å–∞–Ω—ã (“õ–æ—Å—ã–º—à–∞)" min="1">
                <select id="eventType" required>
                    <option value="">–Ü—Å-—à–∞—Ä–∞ —Ç“Ø—Ä—ñ–Ω —Ç–∞“£–¥–∞“£—ã–∑ *</option>
                    <option value="olympiad">–û–ª–∏–º–ø–∏–∞–¥–∞</option>
                    <option value="competition">–ö–æ–Ω–∫—É—Ä—Å</option>
                    <option value="seminar">–°–µ–º–∏–Ω–∞—Ä</option>
                    <option value="conference">–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è</option>
                    <option value="workshop">–°–µ–º–∏–Ω–∞—Ä-–∂–∞—Ç—Ç—ã“ì—É</option>
                    <option value="festival">–§–µ—Å—Ç–∏–≤–∞–ª—å</option>
                </select>
                <textarea id="eventDescription" placeholder="–°–∏–ø–∞—Ç—Ç–∞–º–∞ *" rows="5" required></textarea>
                <input type="url" id="eventImage" placeholder="–°—É—Ä–µ—Ç URL (“õ–æ—Å—ã–º—à–∞)">
                <div class="password-protected">
                    <p><i class="fas fa-lock"></i> –ë“±–ª —Ñ–æ—Ä–º–∞ –ø–∞—Ä–æ–ª—å “õ–∞–∂–µ—Ç –µ—Ç–µ–¥—ñ</p>
                    <div class="password-input">
                        <input type="password" id="adminPassword" placeholder="”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ø–∞—Ä–æ–ª—ñ">
                        <button type="button" id="checkPasswordBtn">–¢–µ–∫—Å–µ—Ä—É</button>
                        <div class="incorrect-password" id="incorrectPassword">“ö–∞—Ç–µ –ø–∞—Ä–æ–ª—å!</div>
                    </div>
                </div>
                <button type="submit" id="submitEventBtn" disabled><i class="fas fa-save"></i> –Ü—Å-—à–∞—Ä–∞–Ω—ã “õ–æ—Å—É</button>
            </form>
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i> –Ü—Å-—à–∞—Ä–∞ —Å”ô—Ç—Ç—ñ “õ–æ—Å—ã–ª–¥—ã! üéâ
            </div>
        </div>
    </div>
    
    <div class="container animate__animated animate__fadeInUp" id="admin">
        <h2><i class="fas fa-user-shield"></i> ”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ü–∞–Ω–µ–ª—ñ</h2>
        
        <div class="password-protected">
            <p><i class="fas fa-lock"></i> ”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ø–∞–Ω–µ–ª—ñ–Ω–µ –∫—ñ—Ä—É “Ø—à—ñ–Ω –ø–∞—Ä–æ–ª—å–¥—ñ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:</p>
            <div class="password-input" id="adminPasswordInput">
                <input type="password" id="adminAccessPassword" placeholder="”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ø–∞—Ä–æ–ª—ñ">
                <button type="button" id="adminAccessBtn">–ö—ñ—Ä—É</button>
                <div class="incorrect-password" id="adminIncorrectPassword">“ö–∞—Ç–µ –ø–∞—Ä–æ–ª—å!</div>
            </div>
        </div>
        
        <div class="tab-container" id="adminTabs" style="display: none;">
            <div class="tabs">
                <div class="tab active" data-tab="participants">“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä</div>
                <div class="tab" data-tab="events">–Ü—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã –±–∞—Å“õ–∞—Ä—É</div>
                <div class="tab" data-tab="stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                <div class="tab" data-tab="settings">–ü–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä</div>
            </div>
            
            <div class="tab-content active" id="participants-tab">
                <div class="admin-panel">
                    <h3><i class="fas fa-users"></i> –¢—ñ—Ä–∫–µ–ª–≥–µ–Ω “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä</h3>
                    <div class="sort-panel">
                        <button class="sort-btn active" data-sort-participants="date-desc">–°–æ“£“ì—ã —Ç—ñ—Ä–∫–µ–ª–≥–µ–Ω–¥–µ—Ä</button>
                        <button class="sort-btn" data-sort-participants="name-asc">–ê—Ç—ã –±–æ–π—ã–Ω—à–∞ (–ê-–Ø)</button>
                        <button class="sort-btn" data-sort-participants="school-asc">–ú–µ–∫—Ç–µ–ø –±–æ–π—ã–Ω—à–∞</button>
                    </div>
                    <button class="export-btn" id="exportParticipants">
                        <i class="fas fa-download"></i> “ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä–¥—ã —ç–∫—Å–ø–æ—Ä—Ç—Ç–∞—É
                    </button>
                    <button class="export-btn" id="exportCSV" style="background: #27ae60;">
                        <i class="fas fa-file-csv"></i> CSV —Ñ–∞–π–ª“ì–∞ —ç–∫—Å–ø–æ—Ä—Ç—Ç–∞—É
                    </button>
                    <div class="participants-list" id="participants-list">
                        <!-- “ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ –æ—Å—ã–Ω–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="events-tab">
                <div class="admin-panel">
                    <h3><i class="fas fa-calendar-alt"></i> –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã –±–∞—Å“õ–∞—Ä—É</h3>
                    <button class="export-btn" id="exportEvents">
                        <i class="fas fa-download"></i> –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã —ç–∫—Å–ø–æ—Ä—Ç—Ç–∞—É
                    </button>
                    <button class="export-btn" id="deleteAllEvents" style="background: #e74c3c;">
                        <i class="fas fa-trash"></i> –ë–∞—Ä–ª—ã“õ —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã –∂–æ—é
                    </button>
                    <div id="admin-events-list">
                        <!-- –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã –±–∞—Å“õ–∞—Ä—É —Ç—ñ–∑—ñ–º—ñ –æ—Å—ã–Ω–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="stats-tab">
                <div class="admin-panel">
                    <h3><i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="chart-container">
                        <canvas id="eventsChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="participantsChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="settings-tab">
                <div class="admin-panel">
                    <h3><i class="fas fa-cog"></i> –ü–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä</h3>
                    <div class="card">
                        <h4>–ñ“Ø–π–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä—ñ</h4>
                        <div class="form-group">
                            <label for="adminEmail">”ò–∫—ñ–º—à—ñ–ª—ñ–∫ email:</label>
                            <input type="email" id="adminEmail" value="admin@olimpiada.kz">
                        </div>
                        <div class="form-group">
                            <label for="telegramBotName">Telegram –±–æ—Ç –∞—Ç—ã:</label>
                            <input type="text" id="telegramBotName" value="@smart_olimpyada_bot">
                        </div>
                        <div class="form-group">
                            <label for="defaultCapacity">”ò–¥–µ–ø–∫—ñ “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä —Å–∞–Ω—ã:</label>
                            <input type="number" id="defaultCapacity" value="100" min="1">
                        </div>
                        <button class="export-btn" id="saveSettings">
                            <i class="fas fa-save"></i> –ü–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä–¥—ñ —Å–∞“õ—Ç–∞—É
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container animate__animated animate__fadeInUp" id="results">
        <h2><i class="fas fa-chart-line"></i> –ù”ô—Ç–∏–∂–µ–ª–µ—Ä –∂”ô–Ω–µ –†–µ–π—Ç–∏–Ω–≥</h2>
        
        <div class="tab-container">
            <div class="tabs">
                <div class="tab active" data-results-tab="ranking">–†–µ–π—Ç–∏–Ω–≥</div>
                <div class="tab" data-results-tab="winners">–ñ–µ“£—ñ–º–ø–∞–∑–¥–∞—Ä</div>
                <div class="tab" data-results-tab="history">–¢–∞—Ä–∏—Ö</div>
            </div>
            
            <div class="tab-content active" id="ranking-tab">
                <div id="results-content">
                    <h3>–û“õ—É—à—ã–ª–∞—Ä —Ä–µ–π—Ç–∏–Ω–≥—ñ</h3>
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>–û—Ä—ã–Ω</th>
                                <th>–û“õ—É—à—ã</th>
                                <th>–ú–µ–∫—Ç–µ–ø</th>
                                <th>“ö–∞–ª–∞</th>
                                <th>“∞–ø–∞–π</th>
                                <th>–Ü—Å-—à–∞—Ä–∞</th>
                            </tr>
                        </thead>
                        <tbody id="ranking-table-body">
                            <!-- –†–µ–π—Ç–∏–Ω–≥ –∫–µ—Å—Ç–µ—Å—ñ –æ—Å—ã–Ω–¥–∞ —Ç–æ–ª—Ç—ã—Ä—ã–ª–∞–¥—ã -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="tab-content" id="winners-tab">
                <div class="card">
                    <h3>–°–æ“£“ì—ã —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã“£ –∂–µ“£—ñ–º–ø–∞–∑–¥–∞—Ä—ã</h3>
                    <div id="winners-list">
                        <!-- –ñ–µ“£—ñ–º–ø–∞–∑–¥–∞—Ä —Ç—ñ–∑—ñ–º—ñ –æ—Å—ã–Ω–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="history-tab">
                <div class="card">
                    <h3>”®—Ç–∫–µ–Ω —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä —Ç–∞—Ä–∏—Ö—ã</h3>
                    <div id="history-list">
                        <!-- –¢–∞—Ä–∏—Ö —Ç—ñ–∑—ñ–º—ñ –æ—Å—ã–Ω–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container animate__animated animate__fadeInUp" id="contact">
        <h2><i class="fas fa-envelope"></i> –ë–∞–π–ª–∞–Ω—ã—Å</h2>
        
        <div class="telegram-section">
            <div class="telegram-banner">
                <i class="fab fa-telegram"></i>
                <h3>–ë—ñ–∑–¥—ñ“£ Telegram –±–æ—Ç—ã–º—ã–∑</h3>
                <p>–û–ª–∏–º–ø–∏–∞–¥–∞–ª–∞—Ä —Ç—É—Ä–∞–ª—ã –µ“£ —Å–æ“£“ì—ã –∞“õ–ø–∞—Ä–∞—Ç—Ç—ã –∞–ª—É “Ø—à—ñ–Ω –±—ñ–∑–¥—ñ“£ Telegram –±–æ—Ç—ã–º—ã–∑“ì–∞ “õ–æ—Å—ã–ª—ã“£—ã–∑!</p>
                <div class="telegram-bot-name">@smart_olimpyada_bot</div>
                <button class="telegram-btn" id="telegram-btn">
                    <i class="fab fa-telegram"></i> –ë–æ—Ç“õ–∞ “õ–æ—Å—ã–ª—É
                </button>
            </div>
            
            <div class="qr-code-container">
                <div class="qr-code-title">
                    <i class="fas fa-qrcode"></i> QR –∫–æ–¥ –∞—Ä“õ—ã–ª—ã “õ–æ—Å—ã–ª—É
                </div>
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=250x250&margin=10&data=https://t.me/smart_olimpyada_bot" 
                     alt="Telegram Bot QR Code"
                     class="qr-code-image">
                <p>Telegram “õ–æ—Å—ã–º—à–∞—Å—ã–Ω—ã“£ –∫–∞–º–µ—Ä–∞—Å—ã–Ω –æ—Å—ã QR –∫–æ–¥“õ–∞ –±–∞“ì—ã—Ç—Ç–∞“£—ã–∑</p>
                
                <button class="copy-bot-btn" id="copy-bot-name">
                    <i class="fas fa-copy"></i> –ë–æ—Ç –∞—Ç—ã–Ω –∫”©—à—ñ—Ä—ñ–ø –∞–ª—É
                </button>
            </div>
        </div>
        
        <div class="founder-info">
            <h3><i class="fas fa-user-tie"></i> –ù–µ–≥—ñ–∑—ñ–Ω “õ–∞–ª–∞—É—à—ã / –û—Å–Ω–æ–≤–∞—Ç–µ–ª—å</h3>
            <p><i class="fas fa-user"></i> –°–∫–µ–Ω–¥–µ—Ä–æ–≤–∞ –ê—Ä–∞–π</p>
            <p><i class="fas fa-phone"></i> –¢–µ–ª–µ—Ñ–æ–Ω: <a href="tel:+77767426757">+7-776-742-6757</a></p>
            <p><i class="fas fa-envelope"></i> Email: <a href="mailto:aray.skenderova@mail.ru">aray.skenderova@mail.ru</a></p>
            <p><i class="fas fa-map-marker-alt"></i> –ú–µ–∫–µ–Ω-–∂–∞–π: –ù“±—Ä-–°“±–ª—Ç–∞–Ω “õ–∞–ª–∞—Å—ã</p>
        </div>
        
        <div class="card">
            <h3><i class="fas fa-comments"></i> –ü—ñ–∫—ñ—Ä “õ–∞–ª–¥—ã—Ä—É</h3>
            <form id="feedbackForm">
                <input type="text" id="feedbackName" placeholder="–ê—Ç—ã-–∂”©–Ω—ñ“£—ñ–∑" required>
                <input type="email" id="feedbackEmail" placeholder="Email" required>
                <textarea id="feedbackMessage" placeholder="–ü—ñ–∫—ñ—Ä—ñ“£—ñ–∑..." rows="4" required></textarea>
                <button type="submit"><i class="fas fa-paper-plane"></i> –ñ—ñ–±–µ—Ä—É</button>
            </form>
        </div>
    </div>
    
    <footer>
        <div class="social-links">
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="https://t.me/smart_olimpyada_bot"><i class="fab fa-telegram"></i></a>
            <a href="#"><i class="fab fa-youtube"></i></a>
        </div>
        <p>&copy; 2025 –†–µ—Å–ø—É–±–ª–∏–∫–∞–ª—ã“õ –ú–µ–∫—Ç–µ–ø –û–ª–∏–º–ø–∏–∞–¥–∞–ª–∞—Ä—ã. –ë–∞—Ä–ª—ã“õ “õ“±“õ—ã“õ—Ç–∞—Ä “õ–æ—Ä“ì–∞–ª“ì–∞–Ω.</p>
        <p>–î–∞–º—É—à—ã –±—ñ–ª—ñ–º –±–µ—Ä—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Å—ã | <span id="current-year">2025</span></p>
    </footer>
    
    <div id="registrationModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="modalTitle"><i class="fas fa-user-plus"></i> –¢—ñ—Ä–∫–µ–ª—É</h2>
            <form id="registrationForm">
                <input type="hidden" id="eventIdForRegistration">
                <input type="text" id="participantName" placeholder="–ê—Ç—ã-–∂”©–Ω—ñ“£—ñ–∑ *" required>
                <input type="email" id="participantEmail" placeholder="–≠–ª–µ–∫—Ç—Ä–æ–Ω–¥—ã“õ –ø–æ—à—Ç–∞ *" required>
                <input type="tel" id="participantPhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ *" required>
                <input type="text" id="participantSchool" placeholder="–ú–µ–∫—Ç–µ–ø –∞—Ç–∞—É—ã *" required>
                <input type="number" id="participantClass" placeholder="–°—ã–Ω—ã–ø *" required min="1" max="11">
                <input type="text" id="participantCity" placeholder="“ö–∞–ª–∞/–ê—É–¥–∞–Ω *" required>
                <button type="submit"><i class="fas fa-check"></i> –¢—ñ—Ä–∫–µ–ª—É–¥—ñ –∞—è“õ—Ç–∞—É</button>
            </form>
            <div class="success-message" id="registrationSuccess" style="display: none;">
                <i class="fas fa-check-circle"></i> –°—ñ–∑ —Å”ô—Ç—Ç—ñ —Ç—ñ—Ä–∫–µ–ª–¥—ñ“£—ñ–∑! üéâ –ë—ñ–∑ —Å—ñ–∑–±–µ–Ω –∂–∞“õ—ã–Ω –∞—Ä–∞–¥–∞ –±–∞–π–ª–∞–Ω—ã—Å–∞–º—ã–∑.
            </div>
        </div>
    </div>
    
    <div id="notificationModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2><i class="fas fa-bell"></i> –•–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä</h2>
            <button class="export-btn" id="markAllRead" style="margin-bottom: 15px;">
                <i class="fas fa-check-double"></i> –ë–∞—Ä–ª—ã“ì—ã–Ω –æ“õ—ã–ª“ì–∞–Ω –¥–µ–ø –±–µ–ª–≥—ñ–ª–µ—É
            </button>
            <div id="notifications-list">
                <!-- –•–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä –æ—Å—ã–Ω–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã -->
            </div>
        </div>
    </div>
    
    <button class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <script>
        // –ö–µ“£–µ–π—Ç—ñ–ª–≥–µ–Ω –º”ô–ª—ñ–º–µ—Ç—Ç–µ—Ä –±–∞–∑–∞—Å—ã
        let events = [
            {
                id: 1,
                name: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –û–ª–∏–º–ø–∏–∞–¥–∞—Å—ã",
                date: "2025-04-15",
                location: "“ö–∞–∑“∞–£",
                type: "olympiad",
                description: "–†–µ—Å–ø—É–±–ª–∏–∫–∞–ª—ã“õ –¥–µ“£–≥–µ–π–¥–µ–≥—ñ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –æ–ª–∏–º–ø–∏–∞–¥–∞—Å—ã. 7-11 —Å—ã–Ω—ã–ø –æ“õ—É—à—ã–ª–∞—Ä—ã–Ω–∞ –∞—Ä–Ω–∞–ª“ì–∞–Ω.",
                image: "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                participants: 124,
                capacity: 200,
                registeredAt: "2025-01-15",
                status: "upcoming",
                categories: ["–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞–ª—ã“õ"]
            },
            {
                id: 2,
                name: "–ê“ì—ã–ª—à—ã–Ω –¢—ñ–ª—ñ –ö–æ–Ω–∫—É—Ä—Å—ã",
                date: "2025-04-20",
                location: "‚Ññ5 –º–µ–∫—Ç–µ–ø",
                type: "competition",
                description: "–ê“ì—ã–ª—à—ã–Ω —Ç—ñ–ª—ñ–Ω–¥–µ —Å”©–π–ª–µ—É, –∂–∞–∑—É –∂”ô–Ω–µ —Ç—ã“£–¥–∞–ø —Ç“Ø—Å—ñ–Ω—É –¥–∞“ì–¥—ã–ª–∞—Ä—ã–Ω —Å—ã–Ω–∞–π—Ç—ã–Ω “õ–∞–ª–∞–ª—ã“õ –∫–æ–Ω–∫—É—Ä—Å.",
                image: "https://images.unsplash.com/photo-1546410531-bb4caa6b424d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                participants: 87,
                capacity: 150,
                registeredAt: "2025-01-20",
                status: "upcoming",
                categories: ["–∞“ì—ã–ª—à—ã–Ω —Ç—ñ–ª—ñ", "“õ–∞–ª–∞–ª—ã“õ"]
            },
            {
                id: 3,
                name: "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ —á–µ–º–ø–∏–æ–Ω–∞—Ç—ã",
                date: "2025-03-25",
                location: "–ù–∞–∑–∞—Ä–±–∞–µ–≤ –ó–∏—è—Ç–∫–µ—Ä–ª—ñ–∫ –º–µ–∫—Ç–µ–±—ñ",
                type: "olympiad",
                description: "–ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—É, –∞–ª–≥–æ—Ä–∏—Ç–º–¥–µ—Ä –∂”ô–Ω–µ –ª–æ–≥–∏–∫–∞–ª—ã“õ –æ–π–ª–∞—É –±–æ–π—ã–Ω—à–∞ —Ä–µ—Å–ø—É–±–ª–∏–∫–∞–ª—ã“õ —á–µ–º–ø–∏–æ–Ω–∞—Ç.",
                image: "https://images.unsplash.com/photo-1517077304055-6e89abbf09b0?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                participants: 56,
                capacity: 100,
                registeredAt: "2025-01-10",
                status: "upcoming",
                categories: ["–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–±–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—É"]
            },
            {
                id: 4,
                name: "“í—ã–ª—ã–º–∏ –∂–æ–±–∞–ª–∞—Ä —Ñ–µ—Å—Ç–∏–≤–∞–ª—ñ",
                date: "2025-05-10",
                location: "–†–µ—Å–ø—É–±–ª–∏–∫–∞–ª—ã“õ “ì—ã–ª—ã–º–∏ –æ—Ä—Ç–∞–ª—ã“õ",
                type: "festival",
                description: "–ñ–∞—Å “ì–∞–ª—ã–º–¥–∞—Ä–¥—ã“£ –∂–æ–±–∞–ª–∞—Ä—ã–Ω “õ–æ—Ä“ì–∞–π—Ç—ã–Ω –∂—ã–ª–¥—ã“õ —Ñ–µ—Å—Ç–∏–≤–∞–ª—å.",
                image: "https://images.unsplash.com/photo-1532094349884-543bc11b234d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                participants: 95,
                capacity: 120,
                registeredAt: "2025-02-01",
                status: "upcoming",
                categories: ["“ì—ã–ª—ã–º", "–∂–æ–±–∞–ª–∞—Ä"]
            }
        ];

        let participants = [
            {
                id: 1,
                name: "“ö“±—Ä–º–∞–Ω–æ–≤ –ê—Å–ª–∞–Ω",
                email: "aslan.k@example.com",
                phone: "+77771234567",
                school: "”ò–ª—ñ–º—Ö–∞–Ω –ï—Ä–º–µ–∫–æ–≤ –∞—Ç—ã–Ω–¥–∞“ì—ã ‚Ññ38 –º–µ–∫—Ç–µ–ø",
                class: "10",
                city: "–ù“±—Ä-–°“±–ª—Ç–∞–Ω",
                eventId: 1,
                eventName: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –û–ª–∏–º–ø–∏–∞–¥–∞—Å—ã",
                registeredAt: "2025-03-10",
                score: 95
            },
            {
                id: 2,
                name: "–û—Ä–∞–∑–±–∞–µ–≤–∞ –ê–π–≥–µ—Ä—ñ–º",
                email: "aigerim.o@example.com",
                phone: "+77772345678",
                school: "–ù–∞–∑–∞—Ä–±–∞–µ–≤ –ó–∏—è—Ç–∫–µ—Ä–ª—ñ–∫ –º–µ–∫—Ç–µ–±—ñ",
                class: "11",
                city: "–ê–ª–º–∞—Ç—ã",
                eventId: 2,
                eventName: "–ê“ì—ã–ª—à—ã–Ω –¢—ñ–ª—ñ –ö–æ–Ω–∫—É—Ä—Å—ã",
                registeredAt: "2025-03-12",
                score: 88
            },
            {
                id: 3,
                name: "–ñ“Ø–Ω—ñ—Å–æ–≤ –ë–∞“õ—ã—Ç",
                email: "bakyt.j@example.com",
                phone: "+77773456789",
                school: "‚Ññ5 –º–µ–∫—Ç–µ–ø",
                class: "9",
                city: "–®—ã–º–∫–µ–Ω—Ç",
                eventId: 3,
                eventName: "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ —á–µ–º–ø–∏–æ–Ω–∞—Ç—ã",
                registeredAt: "2025-03-05",
                score: 92
            }
        ];

        // ”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ø–∞—Ä–æ–ª—ñ
        const ADMIN_PASSWORD = "admin123";
        let isAdminAuthenticated = false;

        // –ñ–∞–ª–ø—ã —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('kk-KZ', options);
        }

        function formatDateTime(dateString) {
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            return new Date(dateString).toLocaleDateString('kk-KZ', options);
        }

        function getEventType(type) {
            const types = {
                'olympiad': '–û–ª–∏–º–ø–∏–∞–¥–∞',
                'competition': '–ö–æ–Ω–∫—É—Ä—Å',
                'seminar': '–°–µ–º–∏–Ω–∞—Ä',
                'conference': '–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è',
                'workshop': '–°–µ–º–∏–Ω–∞—Ä-–∂–∞—Ç—Ç—ã“ì—É',
                'festival': '–§–µ—Å—Ç–∏–≤–∞–ª—å'
            };
            return types[type] || type;
        }

        // –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã –∫”©—Ä—Å–µ—Ç—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function displayEvents(sortType = 'date-asc') {
            const eventsList = document.getElementById('events-list');
            eventsList.innerHTML = '';
            
            if (events.length === 0) {
                eventsList.innerHTML = '<p>“ö–∞–∑—ñ—Ä–≥—ñ —É–∞“õ—ã—Ç—Ç–∞ —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä –∂–æ“õ.</p>';
                return;
            }
            
            // –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã —Å“±—Ä—ã–ø—Ç–∞—É
            let sortedEvents = [...events];
            
            switch(sortType) {
                case 'date-asc':
                    sortedEvents.sort((a, b) => new Date(a.date) - new Date(b.date));
                    break;
                case 'date-desc':
                    sortedEvents.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
                case 'name-asc':
                    sortedEvents.sort((a, b) => a.name.localeCompare(b.name, 'kk'));
                    break;
                case 'participants-desc':
                    sortedEvents.sort((a, b) => b.participants - a.participants);
                    break;
            }
            
            sortedEvents.forEach(event => {
                const eventDate = new Date(event.date);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const timeDiff = eventDate.getTime() - today.getTime();
                const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
                
                let status = 'upcoming';
                let statusText = '–ê–ª–¥–∞“ì—ã';
                let statusClass = 'status-upcoming';
                
                if (daysDiff < 0) {
                    status = 'completed';
                    statusText = '–ê—è“õ—Ç–∞–ª“ì–∞–Ω';
                    statusClass = 'status-completed';
                } else if (daysDiff === 0) {
                    status = 'ongoing';
                    statusText = '–ë“Ø–≥—ñ–Ω';
                    statusClass = 'status-ongoing';
                } else if (daysDiff <= 3) {
                    status = 'urgent';
                    statusText = '–ñ–µ–¥–µ–ª';
                    statusClass = 'status-urgent';
                } else if (daysDiff <= 7) {
                    status = 'ongoing';
                    statusText = '–ñ“Ø—Ä–≥—ñ–∑—ñ–ª—É–¥–µ';
                    statusClass = 'status-ongoing';
                }
                
                // –°—Ç–∞—Ç—É—Å—Ç—ã –∂–∞“£–∞—Ä—Ç—É
                event.status = status;
                
                const capacityPercentage = event.capacity ? Math.min(100, (event.participants / event.capacity) * 100) : 0;
                
                const eventElement = document.createElement('div');
                eventElement.className = `event animate__animated ${status === 'urgent' ? 'urgent-event' : ''}`;
                eventElement.setAttribute('data-type', event.type);
                eventElement.setAttribute('data-status', status);
                
                eventElement.innerHTML = `
                    <div class="event-header">
                        <h3>${event.name} 
                            <span class="event-status ${statusClass}">${statusText}</span>
                            ${daysDiff > 0 ? `<span class="event-countdown">${daysDiff} –∫“Ø–Ω “õ–∞–ª–¥—ã</span>` : ''}
                        </h3>
                        <div class="event-date">${formatDate(event.date)}</div>
                    </div>
                    <div class="event-image">
                        <img src="${event.image}" alt="${event.name}" onerror="this.src='https://images.unsplash.com/photo-1546410531-bb4caa6b424d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'">
                    </div>
                    <div class="event-details">
                        <div class="detail-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${event.location}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-users"></i>
                            <span>${event.participants} “õ–∞—Ç—ã—Å—É—à—ã</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-tag"></i>
                            <span>${getEventType(event.type)}</span>
                        </div>
                    </div>
                    ${event.capacity ? `
                    <div class="capacity-indicator">
                        <div>–û—Ä—ã–Ω —Ç–æ–ª—Ç—ã–ª—É—ã: ${event.participants}/${event.capacity} (${capacityPercentage.toFixed(1)}%)</div>
                        <div class="capacity-bar">
                            <div class="capacity-fill" style="width: ${capacityPercentage}%"></div>
                        </div>
                        ${capacityPercentage >= 90 ? '<p style="color: #e74c3c; font-weight: bold;"><i class="fas fa-exclamation-triangle"></i> –û—Ä—ã–Ω–¥–∞—Ä —Ç–∞—É—Å—ã–ª—ã–ø –∂–∞—Ç—ã—Ä!</p>' : ''}
                    </div>
                    ` : ''}
                    <p>${event.description}</p>
                    <div class="category-tags">
                        ${event.categories ? event.categories.map(cat => `<span class="category-tag">${cat}</span>`).join('') : ''}
                    </div>
                    <button class="register-btn" data-event-id="${event.id}" data-event-name="${event.name}">
                        <i class="fas fa-user-plus"></i> –¢—ñ—Ä–∫–µ–ª—É
                    </button>
                    <button class="details-btn" onclick="showEventDetails(${event.id})" style="background: #9b59b6;">
                        <i class="fas fa-info-circle"></i> –¢–æ–ª—ã“ì—ã—Ä–∞“õ
                    </button>
                    ${status === 'completed' ? '<button class="results-btn" onclick="showEventResults(' + event.id + ')" style="background: #3498db; margin-left: 10px;"><i class="fas fa-chart-bar"></i> –ù”ô—Ç–∏–∂–µ–ª–µ—Ä</button>' : ''}
                `;
                eventsList.appendChild(eventElement);
            });
            
            // –¢—ñ—Ä–∫–µ–ª—É –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä—ã–Ω–∞ –æ“õ–∏“ì–∞ “õ–æ—Å—É
            document.querySelectorAll('.register-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const eventId = this.getAttribute('data-event-id');
                    const eventName = this.getAttribute('data-event-name');
                    openRegistrationModal(eventId, eventName);
                });
            });
            
            updateStats();
        }

        // –Ü—Å-—à–∞—Ä–∞ —Ç—É—Ä–∞–ª—ã —Ç–æ–ª—ã“õ –∞“õ–ø–∞—Ä–∞—Ç
        function showEventDetails(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;
            
            const modal = document.getElementById('registrationModal');
            const modalTitle = document.getElementById('modalTitle');
            const registrationForm = document.getElementById('registrationForm');
            
            modalTitle.innerHTML = `<i class="fas fa-info-circle"></i> "${event.name}" —Ç—É—Ä–∞–ª—ã —Ç–æ–ª—ã“õ –∞“õ–ø–∞—Ä–∞—Ç`;
            registrationForm.style.display = 'none';
            
            const eventDetails = document.createElement('div');
            eventDetails.innerHTML = `
                <div class="event">
                    <div class="event-header">
                        <h3>${event.name}</h3>
                        <div class="event-date">${formatDate(event.date)}</div>
                    </div>
                    <img src="${event.image}" style="width:100%; border-radius:8px; margin:15px 0;">
                    <div class="event-details">
                        <div class="detail-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span><strong>–û—Ä—ã–Ω:</strong> ${event.location}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-users"></i>
                            <span><strong>“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä:</strong> ${event.participants}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-tag"></i>
                            <span><strong>–¢“Ø—Ä—ñ:</strong> ${getEventType(event.type)}</span>
                        </div>
                    </div>
                    <p><strong>–°–∏–ø–∞—Ç—Ç–∞–º–∞:</strong> ${event.description}</p>
                    ${event.capacity ? `<p><strong>–°—ã–π—ã–º–¥—ã–ª—ã“õ:</strong> ${event.capacity} –∞–¥–∞–º</p>` : ''}
                    <button onclick="openRegistrationModal(${event.id}, '${event.name}')" class="register-btn" style="margin-top:20px;">
                        <i class="fas fa-user-plus"></i> –û—Å—ã —ñ—Å-—à–∞—Ä–∞“ì–∞ —Ç—ñ—Ä–∫–µ–ª—É
                    </button>
                </div>
            `;
            
            modal.querySelector('.modal-content').appendChild(eventDetails);
            modal.style.display = 'block';
            
            modal.querySelector('.close-btn').onclick = () => {
                modal.style.display = 'none';
                eventDetails.remove();
                registrationForm.style.display = 'block';
            };
        }

        // –ù”ô—Ç–∏–∂–µ–ª–µ—Ä–¥—ñ –∫”©—Ä—Å–µ—Ç—É
        function showEventResults(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;
            
            const eventParticipants = participants.filter(p => p.eventId === eventId);
            
            const modal = document.getElementById('registrationModal');
            const modalTitle = document.getElementById('modalTitle');
            const registrationForm = document.getElementById('registrationForm');
            
            modalTitle.innerHTML = `<i class="fas fa-trophy"></i> "${event.name}" –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä—ñ`;
            registrationForm.style.display = 'none';
            
            const resultsDiv = document.createElement('div');
            
            if (eventParticipants.length > 0) {
                // “∞–ø–∞–π –±–æ–π—ã–Ω—à–∞ —Å“±—Ä—ã–ø—Ç–∞—É
                const sortedParticipants = [...eventParticipants].sort((a, b) => (b.score || 0) - (a.score || 0));
                
                let resultsHTML = `
                    <h3>–ñ–µ“£—ñ–º–ø–∞–∑–¥–∞—Ä:</h3>
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>–û—Ä—ã–Ω</th>
                                <th>–û“õ—É—à—ã</th>
                                <th>–ú–µ–∫—Ç–µ–ø</th>
                                <th>“∞–ø–∞–π</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                sortedParticipants.forEach((participant, index) => {
                    let medal = '';
                    if (index === 0) medal = '<span class="medal gold">ü•á</span>';
                    else if (index === 1) medal = '<span class="medal silver">ü•à</span>';
                    else if (index === 2) medal = '<span class="medal bronze">ü•â</span>';
                    
                    resultsHTML += `
                        <tr>
                            <td>${index + 1} ${medal}</td>
                            <td>${participant.name}</td>
                            <td>${participant.school}</td>
                            <td>${participant.score || 0}</td>
                        </tr>
                    `;
                });
                
                resultsHTML += `</tbody></table>`;
                resultsDiv.innerHTML = resultsHTML;
            } else {
                resultsDiv.innerHTML = '<p>–ë“±–ª —ñ—Å-—à–∞—Ä–∞–¥–∞ “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä –∂–æ“õ –Ω–µ–º–µ—Å–µ –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä ”ô–ª—ñ –∂–∞—Ä–∏—è–ª–∞–Ω–±–∞–¥—ã.</p>';
            }
            
            modal.querySelector('.modal-content').appendChild(resultsDiv);
            modal.style.display = 'block';
            
            modal.querySelector('.close-btn').onclick = () => {
                modal.style.display = 'none';
                resultsDiv.remove();
                registrationForm.style.display = 'block';
            };
        }

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–Ω—ã –∂–∞“£–∞—Ä—Ç—É
        function updateStats() {
            const today = new Date();
            const upcomingCount = events.filter(event => new Date(event.date) >= today).length;
            const ongoingCount = events.filter(event => {
                const eventDate = new Date(event.date);
                const daysDiff = Math.ceil((eventDate - today) / (1000 * 3600 * 24));
                return daysDiff >= 0 && daysDiff <= 7;
            }).length;
            const uniqueSchools = [...new Set(participants.map(p => p.school))].length;
            const totalParticipants = participants.reduce((sum, p) => sum + 1, 0);
            
            document.getElementById('total-events').textContent = events.length;
            document.getElementById('total-participants').textContent = totalParticipants;
            document.getElementById('total-schools').textContent = uniqueSchools;
            document.getElementById('upcoming-events').textContent = upcomingCount;
        }

        // “ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä–¥—ã –∫”©—Ä—Å–µ—Ç—É
        function displayParticipants(sortType = 'date-desc') {
            const participantsList = document.getElementById('participants-list');
            participantsList.innerHTML = '';
            
            if (participants.length === 0) {
                participantsList.innerHTML = '<p>“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ –±–æ—Å.</p>';
                return;
            }
            
            // –°“±—Ä—ã–ø—Ç–∞—É
            let sortedParticipants = [...participants];
            
            switch(sortType) {
                case 'date-desc':
                    sortedParticipants.sort((a, b) => new Date(b.registeredAt) - new Date(a.registeredAt));
                    break;
                case 'name-asc':
                    sortedParticipants.sort((a, b) => a.name.localeCompare(b.name, 'kk'));
                    break;
                case 'school-asc':
                    sortedParticipants.sort((a, b) => a.school.localeCompare(b.school, 'kk'));
                    break;
            }
            
            sortedParticipants.forEach(participant => {
                const participantElement = document.createElement('div');
                participantElement.className = 'participant-item';
                participantElement.innerHTML = `
                    <div>
                        <strong>${participant.name}</strong><br>
                        <small>${participant.school}, ${participant.class} —Å—ã–Ω—ã–ø</small><br>
                        <small>${participant.city} | ${participant.phone} | ${participant.email}</small>
                    </div>
                    <div>
                        <small><strong>${participant.eventName}</strong></small><br>
                        <small>–¢—ñ—Ä–∫–µ–ª–≥–µ–Ω: ${formatDateTime(participant.registeredAt)}</small>
                        ${participant.score ? `<br><small>“∞–ø–∞–π: ${participant.score}</small>` : ''}
                    </div>
                `;
                participantsList.appendChild(participantElement);
            });
        }

        // ”ò–∫—ñ–º—à—ñ–ª—ñ–∫ —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ
        function displayAdminEvents() {
            const adminEventsList = document.getElementById('admin-events-list');
            adminEventsList.innerHTML = '';
            
            events.forEach(event => {
                const eventDate = new Date(event.date);
                const today = new Date();
                const daysDiff = Math.ceil((eventDate - today) / (1000 * 3600 * 24));
                
                const eventElement = document.createElement('div');
                eventElement.className = 'event';
                eventElement.innerHTML = `
                    <div class="event-header">
                        <h3>${event.name} <small>(${event.id})</small></h3>
                        <div class="event-date">${formatDate(event.date)}</div>
                    </div>
                    <p>${event.description}</p>
                    <div class="event-details">
                        <div class="detail-item">
                            <i class="fas fa-users"></i>
                            <span>${event.participants} “õ–∞—Ç—ã—Å—É—à—ã</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${event.location}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-calendar"></i>
                            <span>${daysDiff} –∫“Ø–Ω “õ–∞–ª–¥—ã</span>
                        </div>
                    </div>
                    <div class="event-actions">
                        <button class="edit-event-btn" data-event-id="${event.id}">
                            <i class="fas fa-edit"></i> ”®–∑–≥–µ—Ä—Ç—É
                        </button>
                        <button class="view-participants-btn" onclick="viewEventParticipants(${event.id})" style="background: #9b59b6;">
                            <i class="fas fa-users"></i> “ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä
                        </button>
                        <button class="delete-event-btn" data-event-id="${event.id}" style="background: #e74c3c;">
                            <i class="fas fa-trash"></i> –ñ–æ—é
                        </button>
                    </div>
                `;
                adminEventsList.appendChild(eventElement);
            });
            
            // ”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä—ã–Ω–∞ –æ“õ–∏“ì–∞ “õ–æ—Å—É
            document.querySelectorAll('.edit-event-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const eventId = parseInt(this.getAttribute('data-event-id'));
                    editEvent(eventId);
                });
            });
            
            document.querySelectorAll('.delete-event-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const eventId = parseInt(this.getAttribute('data-event-id'));
                    if (confirm('–Ü—Å-—à–∞—Ä–∞–Ω—ã –∂–æ—é“ì–∞ —Å–µ–Ω—ñ–º–¥—ñ—Å—ñ–∑ –±–µ? –ë“±–ª ”ô—Ä–µ–∫–µ—Ç—Ç—ñ –∫–µ—Ä—ñ “õ–∞–π—Ç–∞—Ä—É –º“Ø–º–∫—ñ–Ω –µ–º–µ—Å.')) {
                        deleteEvent(eventId);
                    }
                });
            });
        }

        // –Ü—Å-—à–∞—Ä–∞ “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä—ã–Ω –∫”©—Ä—É
        function viewEventParticipants(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;
            
            const eventParticipants = participants.filter(p => p.eventId === eventId);
            
            const modal = document.getElementById('registrationModal');
            const modalTitle = document.getElementById('modalTitle');
            const registrationForm = document.getElementById('registrationForm');
            
            modalTitle.innerHTML = `<i class="fas fa-users"></i> "${event.name}" —ñ—Å-—à–∞—Ä–∞—Å—ã–Ω—ã“£ “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä—ã`;
            registrationForm.style.display = 'none';
            
            const participantsDiv = document.createElement('div');
            
            if (eventParticipants.length > 0) {
                let participantsHTML = `
                    <h3>“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä (${eventParticipants.length} –∞–¥–∞–º):</h3>
                    <div class="participants-list">
                `;
                
                eventParticipants.forEach(participant => {
                    participantsHTML += `
                        <div class="participant-item">
                            <div>
                                <strong>${participant.name}</strong><br>
                                <small>${participant.school}, ${participant.class} —Å—ã–Ω—ã–ø</small><br>
                                <small>${participant.city} | ${participant.phone}</small>
                            </div>
                            <div>
                                <small>–¢—ñ—Ä–∫–µ–ª–≥–µ–Ω: ${formatDate(participant.registeredAt)}</small>
                            </div>
                        </div>
                    `;
                });
                
                participantsHTML += `</div>`;
                participantsDiv.innerHTML = participantsHTML;
            } else {
                participantsDiv.innerHTML = '<p>–ë“±–ª —ñ—Å-—à–∞—Ä–∞–¥–∞ “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä –∂–æ“õ.</p>';
            }
            
            modal.querySelector('.modal-content').appendChild(participantsDiv);
            modal.style.display = 'block';
            
            modal.querySelector('.close-btn').onclick = () => {
                modal.style.display = 'none';
                participantsDiv.remove();
                registrationForm.style.display = 'block';
            };
        }

        // –¢—ñ—Ä–∫–µ–ª—É –º–æ–¥–∞–ª—å–¥—ã —Ç–µ—Ä–µ–∑–µ—Å—ñ
        function openRegistrationModal(eventId, eventName) {
            const modal = document.getElementById('registrationModal');
            const modalTitle = document.getElementById('modalTitle');
            const eventIdInput = document.getElementById('eventIdForRegistration');
            const registrationForm = document.getElementById('registrationForm');
            
            modalTitle.innerHTML = `<i class="fas fa-user-plus"></i> "${eventName}" —ñ—Å-—à–∞—Ä–∞—Å—ã–Ω–∞ —Ç—ñ—Ä–∫–µ–ª—É`;
            eventIdInput.value = eventId;
            registrationForm.style.display = 'block';
            
            // –ë–∞—Å“õ–∞ –º–∞–∑–º“±–Ω–¥—ã –∂–æ—é (–µ–≥–µ—Ä –±–∞—Ä –±–æ–ª—Å–∞)
            const existingContent = modal.querySelector('.modal-content > div:not(:first-child):not(:last-child)');
            if (existingContent) {
                existingContent.remove();
            }
            
            modal.style.display = 'block';
            
            // –ú–æ–¥–∞–ª—å–¥—ã —Ç–µ—Ä–µ–∑–µ–Ω—ñ –∂–∞–±—É
            modal.querySelector('.close-btn').onclick = () => {
                modal.style.display = 'none';
            };
            
            window.onclick = (event) => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            };
        }

        // –ñ–∞“£–∞ —ñ—Å-—à–∞—Ä–∞ “õ–æ—Å—É
        function addNewEvent(eventData) {
            const newEvent = {
                id: events.length > 0 ? Math.max(...events.map(e => e.id)) + 1 : 1,
                ...eventData,
                participants: 0,
                registeredAt: new Date().toISOString().split('T')[0],
                status: "upcoming",
                categories: eventData.type === "olympiad" ? ["–æ–ª–∏–º–ø–∏–∞–¥–∞"] : 
                           eventData.type === "competition" ? ["–∫–æ–Ω–∫—É—Ä—Å"] : 
                           eventData.type === "festival" ? ["—Ñ–µ—Å—Ç–∏–≤–∞–ª—å"] : ["–±–∞—Å“õ–∞"]
            };
            
            events.push(newEvent);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —ç—Ñ—Ñ–µ–∫—Ç—ñ—Å—ñ
            const eventsList = document.getElementById('events-list');
            eventsList.scrollIntoView({ behavior: 'smooth' });
            
            displayEvents();
            displayAdminEvents();
            
            // –•–∞–±–∞—Ä–ª–∞–º–∞ “õ–æ—Å—É
            addNotification(`–ñ–∞“£–∞ —ñ—Å-—à–∞—Ä–∞ “õ–æ—Å—ã–ª–¥—ã: "${eventData.name}"`, 'success');
            
            // –ñ–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ —Å–∞“õ—Ç–∞—É
            saveToLocalStorage();
            
            return newEvent.id;
        }

        // –Ü—Å-—à–∞—Ä–∞–Ω—ã ”©–∑–≥–µ—Ä—Ç—É
        function editEvent(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;
            
            const newName = prompt('–Ü—Å-—à–∞—Ä–∞–Ω—ã“£ –∂–∞“£–∞ –∞—Ç–∞—É—ã:', event.name);
            if (newName && newName.trim() !== '') {
                event.name = newName.trim();
                
                const newLocation = prompt('–ñ–∞“£–∞ –æ—Ä—ã–Ω:', event.location);
                if (newLocation && newLocation.trim() !== '') {
                    event.location = newLocation.trim();
                }
                
                const newCapacity = prompt('–ñ–∞“£–∞ —Å—ã–π—ã–º–¥—ã–ª—ã“õ (–±–æ—Å –±–æ–ª—Å–∞, –µ—Å–∫—ñ –º”ô–Ω—ñ —Å–∞“õ—Ç–∞–ª–∞–¥—ã):', event.capacity);
                if (newCapacity && !isNaN(newCapacity) && parseInt(newCapacity) > 0) {
                    event.capacity = parseInt(newCapacity);
                }
                
                displayEvents();
                displayAdminEvents();
                addNotification(`"${event.name}" —ñ—Å-—à–∞—Ä–∞—Å—ã ”©–∑–≥–µ—Ä—Ç—ñ–ª–¥—ñ`, 'info');
                saveToLocalStorage();
            }
        }

        // –Ü—Å-—à–∞—Ä–∞–Ω—ã –∂–æ—é
        function deleteEvent(eventId) {
            const eventIndex = events.findIndex(e => e.id === eventId);
            if (eventIndex === -1) return;
            
            const eventName = events[eventIndex].name;
            events.splice(eventIndex, 1);
            
            // –°–æ–ª —ñ—Å-—à–∞—Ä–∞“ì–∞ —Ç—ñ—Ä–∫–µ–ª–≥–µ–Ω “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä–¥—ã –¥–∞ –∂–æ—é
            participants = participants.filter(p => p.eventId !== eventId);
            
            displayEvents();
            displayParticipants();
            displayAdminEvents();
            addNotification(`"${eventName}" —ñ—Å-—à–∞—Ä–∞—Å—ã –∂–æ–π—ã–ª–¥—ã`, 'warning');
            saveToLocalStorage();
        }

        // –•–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä–¥—ã –±–∞—Å“õ–∞—Ä—É
        let notifications = [
            { id: 1, text: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –æ–ª–∏–º–ø–∏–∞–¥–∞—Å—ã–Ω–∞ —Ç—ñ—Ä–∫–µ–ª—É 2 –∫“Ø–Ω–Ω–µ–Ω –∫–µ–π—ñ–Ω –∞—è“õ—Ç–∞–ª–∞–¥—ã", type: "urgent", date: "2025-03-13", read: false },
            { id: 2, text: "–ñ–∞“£–∞ —Å–µ–º–∏–Ω–∞—Ä “õ–æ—Å—ã–ª–¥—ã: '“í—ã–ª—ã–º–∏ –∂–æ–±–∞ –∂–∞—Å–∞—É'", type: "info", date: "2025-03-12", read: false },
            { id: 3, text: "–ê“ì—ã–ª—à—ã–Ω —Ç—ñ–ª—ñ –∫–æ–Ω–∫—É—Ä—Å—ã–Ω—ã“£ –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä—ñ –∂–∞—Ä–∏—è–ª–∞–Ω–¥—ã", type: "success", date: "2025-03-10", read: false }
        ];

        function displayNotifications() {
            const notificationsList = document.getElementById('notifications-list');
            notificationsList.innerHTML = '';
            
            const unreadCount = notifications.filter(n => !n.read).length;
            document.getElementById('notificationCount').textContent = unreadCount;
            
            if (notifications.length === 0) {
                notificationsList.innerHTML = '<p>–•–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä –∂–æ“õ.</p>';
                return;
            }
            
            // –ö–µ—Ä—ñ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è–ª—ã“õ —Ä–µ—Ç–ø–µ–Ω –∫”©—Ä—Å–µ—Ç—É
            const sortedNotifications = [...notifications].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedNotifications.forEach(notif => {
                const notifElement = document.createElement('div');
                notifElement.className = `notification-item ${notif.type} ${notif.read ? 'read' : 'unread'}`;
                notifElement.innerHTML = `
                    <p>${notif.text}</p>
                    <small>${formatDate(notif.date)} ${notif.read ? '¬∑ –û“õ—ã–ª“ì–∞–Ω' : '¬∑ –ñ–∞“£–∞'}</small>
                `;
                
                // –û“õ—ã–ª“ì–∞–Ω –¥–µ–ø –±–µ–ª–≥—ñ–ª–µ—É
                notifElement.addEventListener('click', function() {
                    if (!notif.read) {
                        notif.read = true;
                        displayNotifications();
                    }
                });
                
                notificationsList.appendChild(notifElement);
            });
        }

        function addNotification(text, type = 'info') {
            const newNotification = {
                id: notifications.length > 0 ? Math.max(...notifications.map(n => n.id)) + 1 : 1,
                text: text,
                type: type,
                date: new Date().toISOString().split('T')[0],
                read: false
            };
            
            notifications.unshift(newNotification);
            displayNotifications();
            
            // –î—ã–±—ã—Å –æ–π–Ω–∞—Ç—É (—Ç–µ–∫ –∂–µ–¥–µ–ª —Ö–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä “Ø—à—ñ–Ω)
            if (type === 'urgent') {
                try {
                    const audio = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3');
                    audio.volume = 0.3;
                    audio.play().catch(e => console.log('–î—ã–±—ã—Å –æ–π–Ω–∞—Ç—É “õ–∞—Ç–µ—Å—ñ:', e));
                } catch (e) {
                    console.log('–î—ã–±—ã—Å “õ–∞—Ç–µ—Å—ñ:', e);
                }
            }
        }

        // –°“Ø–∑–≥—ñ–ª–µ—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function setupFilters() {
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const filter = this.getAttribute('data-filter');
                    filterEvents(filter);
                });
            });
        }

        function filterEvents(filter) {
            const eventElements = document.querySelectorAll('.event');
            let count = 0;
            
            eventElements.forEach(event => {
                const eventType = event.getAttribute('data-type');
                const isUrgent = event.classList.contains('urgent-event');
                const status = event.getAttribute('data-status');
                
                let showEvent = false;
                
                switch(filter) {
                    case 'all':
                        showEvent = true;
                        break;
                    case 'olympiad':
                        showEvent = eventType === 'olympiad';
                        break;
                    case 'competition':
                        showEvent = eventType === 'competition';
                        break;
                    case 'urgent':
                        showEvent = isUrgent;
                        break;
                    case 'upcoming':
                        showEvent = status === 'upcoming';
                        break;
                    case 'ongoing':
                        showEvent = status === 'ongoing' || status === 'urgent';
                        break;
                    default:
                        showEvent = true;
                }
                
                if (showEvent) {
                    event.style.display = 'block';
                    event.classList.add('animate__animated', 'animate__fadeIn');
                    count++;
                } else {
                    event.style.display = 'none';
                }
            });
            
            // –ï—à—Ç–µ“£–µ —Ç–∞–±—ã–ª–º–∞—Å–∞ —Ö–∞–±–∞—Ä–ª–∞—É
            if (count === 0) {
                const eventsList = document.getElementById('events-list');
                const noResults = document.createElement('p');
                noResults.textContent = '–°“Ø–∑–≥—ñ –±–æ–π—ã–Ω—à–∞ —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä —Ç–∞–±—ã–ª–º–∞–¥—ã.';
                noResults.style.textAlign = 'center';
                noResults.style.padding = '20px';
                noResults.style.color = '#666';
                
                // –ï–≥–µ—Ä –∞–ª–¥—ã“£“ì—ã —Ö–∞–±–∞—Ä–ª–∞–º–∞ –∂–æ“õ –±–æ–ª—Å–∞ “ì–∞–Ω–∞ “õ–æ—Å—É
                if (!eventsList.querySelector('.no-results-message')) {
                    noResults.className = 'no-results-message';
                    eventsList.appendChild(noResults);
                }
            } else {
                // –•–∞–±–∞—Ä–ª–∞–º–∞–Ω—ã –∂–æ—é
                const noResults = document.querySelector('.no-results-message');
                if (noResults) {
                    noResults.remove();
                }
            }
        }

        // –°“±—Ä—ã–ø—Ç–∞—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function setupSorting() {
            const sortBtns = document.querySelectorAll('.sort-btn');
            sortBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    sortBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const sortType = this.getAttribute('data-sort');
                    displayEvents(sortType);
                });
            });
            
            // “ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä–¥—ã —Å“±—Ä—ã–ø—Ç–∞—É
            const participantSortBtns = document.querySelectorAll('[data-sort-participants]');
            participantSortBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    participantSortBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const sortType = this.getAttribute('data-sort-participants');
                    displayParticipants(sortType);
                });
            });
        }

        // “ö–∞—Ä–∞“£“ì—ã —Ä–µ–∂–∏–º
        function setupDarkMode() {
            const darkModeToggle = document.getElementById('darkModeToggle');
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            darkModeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('darkMode', 'true');
                    this.innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    localStorage.setItem('darkMode', 'false');
                    this.innerHTML = '<i class="fas fa-moon"></i>';
                }
            });
        }

        // –î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ —ç–∫—Å–ø–æ—Ä—Ç—Ç–∞—É
        function setupExport() {
            document.getElementById('exportParticipants').addEventListener('click', function() {
                exportData('participants');
            });
            
            document.getElementById('exportEvents').addEventListener('click', function() {
                exportData('events');
            });
            
            document.getElementById('exportCSV').addEventListener('click', function() {
                exportCSVData();
            });
            
            document.getElementById('deleteAllEvents').addEventListener('click', function() {
                if (confirm('–ë–∞—Ä–ª—ã“õ —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã –∂–æ—é“ì–∞ —Å–µ–Ω—ñ–º–¥—ñ—Å—ñ–∑ –±–µ? –ë“±–ª ”ô—Ä–µ–∫–µ—Ç—Ç—ñ –∫–µ—Ä—ñ “õ–∞–π—Ç–∞—Ä—É –º“Ø–º–∫—ñ–Ω –µ–º–µ—Å.')) {
                    events = [];
                    participants = [];
                    displayEvents();
                    displayParticipants();
                    displayAdminEvents();
                    addNotification('–ë–∞—Ä–ª—ã“õ —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä –∂–æ–π—ã–ª–¥—ã', 'warning');
                    saveToLocalStorage();
                }
            });
        }

        function exportData(type) {
            let data, filename;
            
            if (type === 'participants') {
                data = participants;
                filename = `“õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä-${new Date().toISOString().split('T')[0]}.json`;
            } else {
                data = events;
                filename = `—ñ—Å-—à–∞—Ä–∞–ª–∞—Ä-${new Date().toISOString().split('T')[0]}.json`;
            }
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            addNotification(`${type === 'participants' ? '“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä' : '–Ü—Å-—à–∞—Ä–∞–ª–∞—Ä'} —Å”ô—Ç—Ç—ñ —ç–∫—Å–ø–æ—Ä—Ç—Ç–∞–ª–¥—ã!`, 'success');
        }

        function exportCSVData() {
            if (participants.length === 0) {
                alert('–≠–∫—Å–ø–æ—Ä—Ç—Ç–∞—É “Ø—à—ñ–Ω “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä –∂–æ“õ!');
                return;
            }
            
            // CSV –±–∞—Å—ã
            let csv = '–ê—Ç—ã-–∂”©–Ω—ñ,Email,–¢–µ–ª–µ—Ñ–æ–Ω,–ú–µ–∫—Ç–µ–ø,–°—ã–Ω—ã–ø,“ö–∞–ª–∞,–Ü—Å-—à–∞—Ä–∞,–¢—ñ—Ä–∫–µ–ª–≥–µ–Ω –∫“Ø–Ω—ñ\n';
            
            // –î–µ—Ä–µ–∫—Ç–µ—Ä
            participants.forEach(p => {
                csv += `"${p.name}","${p.email}","${p.phone}","${p.school}",${p.class},"${p.city}","${p.eventName}","${p.registeredAt}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `“õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            addNotification('“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä CSV —Ñ–∞–π–ª—ã–Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç—Ç–∞–ª–¥—ã!', 'success');
        }

        // –û–Ω–ª–∞–π–Ω “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä —Å–∞–Ω—ã–Ω —ç–º—É–ª—è—Ü–∏—è–ª–∞—É
        function updateLiveParticipants() {
            const liveCount = Math.floor(Math.random() * 50) + 20;
            document.getElementById('live-participants').textContent = liveCount;
        }

        // –£–∞“õ—ã—Ç—Ç—ã –∂–∞“£–∞—Ä—Ç—É
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('kk-KZ', { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('current-time').textContent = timeString;
        }

        // –ñ—ã–ª–¥—ã –∂–∞“£–∞—Ä—Ç—É
        function updateCurrentYear() {
            document.getElementById('current-year').textContent = new Date().getFullYear();
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è–Ω—ã –±–∞—Å“õ–∞—Ä—É
        function setupNavigation() {
            const navLinks = document.querySelectorAll('nav a');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    if (this.getAttribute('href').startsWith('#')) {
                        e.preventDefault();
                        
                        // –ë–µ–ª—Å–µ–Ω–¥—ñ –∫–ª–∞—Å—Å—ã–Ω ”©–∑–≥–µ—Ä—Ç—É
                        navLinks.forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                        
                        // –ú–∞“õ—Å–∞—Ç—Ç—ã –±”©–ª—ñ–º–≥–µ ”©—Ç—É
                        const targetId = this.getAttribute('href').substring(1);
                        const targetElement = document.getElementById(targetId);
                        
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 70,
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            });
        }

        // Telegram –±–æ—Ç —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä—ã
        function setupTelegramBot() {
            // Telegram –±–æ—Ç“õ–∞ –±–∞“ì—ã—Ç—Ç–∞—É
            document.getElementById('telegram-btn').addEventListener('click', function(e) {
                e.preventDefault();
                const telegramUrl = 'tg://resolve?domain=smart_olimpyada_bot';
                const webUrl = 'https://t.me/smart_olimpyada_bot';
                
                // Telegram “õ–æ—Å—ã–º—à–∞—Å—ã–Ω–¥–∞ –∞—à—É“ì–∞ —Ç—ã—Ä—ã—Å—É
                window.open(telegramUrl, '_blank');
                
                // –ï–≥–µ—Ä Telegram “õ–æ—Å—ã–º—à–∞—Å—ã –∂–æ“õ –±–æ–ª—Å–∞, –≤–µ–±-–Ω“±—Å“õ–∞“ì–∞ –±–∞“ì—ã—Ç—Ç–∞—É
                setTimeout(() => {
                    if (!document.hidden) {
                        window.open(webUrl, '_blank');
                    }
                }, 500);
            });

            // –ë–æ—Ç –∞—Ç—ã–Ω –∫”©—à—ñ—Ä—ñ–ø –∞–ª—É
            document.getElementById('copy-bot-name').addEventListener('click', function() {
                navigator.clipboard.writeText('@smart_olimpyada_bot').then(function() {
                    alert('–ë–æ—Ç –∞—Ç—ã –∫”©—à—ñ—Ä—ñ–ª–¥—ñ! Telegram-–¥–∞ —ñ–∑–¥–µ—É –∂–æ–ª–∞“ì—ã–Ω–∞ "@smart_olimpyada_bot" –¥–µ–ø –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑.');
                }).catch(function(err) {
                    // –ö”©—à—ñ—Ä—É —Å”ô—Ç—Å—ñ–∑ –∞—è“õ—Ç–∞–ª—Å–∞, “õ–æ–ª–º–µ–Ω –∫”©—à—ñ—Ä—É ”ô–¥—ñ—Å—ñ
                    const textArea = document.createElement('textarea');
                    textArea.value = '@smart_olimpyada_bot';
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('–ë–æ—Ç –∞—Ç—ã –∫”©—à—ñ—Ä—ñ–ª–¥—ñ!');
                });
            });
        }

        // –¢–∞–±—ã–ª–∞—Ä–¥—ã –±–∞—Å“õ–∞—Ä—É
        function setupTabs() {
            // ”ò–∫—ñ–º—à—ñ–ª—ñ–∫ —Ç–∞–±—ã–ª–∞—Ä—ã
            const adminTabs = document.querySelectorAll('#adminTabs .tab');
            const adminTabContents = document.querySelectorAll('#adminTabs .tab-content');
            
            adminTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // –ë–µ–ª—Å–µ–Ω–¥—ñ –∫–ª–∞—Å—Å—ã–Ω ”©–∑–≥–µ—Ä—Ç—É
                    adminTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // –¢–∞–ø –º–∞–∑–º“±–Ω—ã–Ω –∫”©—Ä—Å–µ—Ç—É/–∂–∞—Å—ã—Ä—É
                    adminTabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabId}-tab`) {
                            content.classList.add('active');
                            
                            // –ì—Ä–∞—Ñ–∏–∫—Ç–µ—Ä–¥—ñ –∂–∞“£–∞—Ä—Ç—É
                            if (tabId === 'stats') {
                                updateCharts();
                            }
                        }
                    });
                });
            });
            
            // –ù”ô—Ç–∏–∂–µ–ª–µ—Ä —Ç–∞–±—ã–ª–∞—Ä—ã
            const resultsTabs = document.querySelectorAll('[data-results-tab]');
            const resultsTabContents = document.querySelectorAll('#results .tab-content');
            
            resultsTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-results-tab');
                    
                    // –ë–µ–ª—Å–µ–Ω–¥—ñ –∫–ª–∞—Å—Å—ã–Ω ”©–∑–≥–µ—Ä—Ç—É
                    resultsTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // –¢–∞–ø –º–∞–∑–º“±–Ω—ã–Ω –∫”©—Ä—Å–µ—Ç—É/–∂–∞—Å—ã—Ä—É
                    resultsTabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabId}-tab`) {
                            content.classList.add('active');
                            
                            // –ú–∞–∑–º“±–Ω–¥—ã –∂–∞“£–∞—Ä—Ç—É
                            if (tabId === 'ranking') {
                                updateRankingTable();
                            } else if (tabId === 'winners') {
                                updateWinnersList();
                            } else if (tabId === 'history') {
                                updateHistoryList();
                            }
                        }
                    });
                });
            });
        }

        // –†–µ–π—Ç–∏–Ω–≥ –∫–µ—Å—Ç–µ—Å—ñ–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateRankingTable() {
            const tableBody = document.getElementById('ranking-table-body');
            tableBody.innerHTML = '';
            
            if (participants.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" style="text-align:center;">–î–µ—Ä–µ–∫—Ç–µ—Ä –∂–æ“õ</td></tr>';
                return;
            }
            
            // “∞–ø–∞–π –±–æ–π—ã–Ω—à–∞ —Å“±—Ä—ã–ø—Ç–∞—É
            const sortedParticipants = [...participants].sort((a, b) => (b.score || 0) - (a.score || 0));
            
            sortedParticipants.forEach((participant, index) => {
                let medal = '';
                if (index === 0) medal = '<span class="medal gold">ü•á</span>';
                else if (index === 1) medal = '<span class="medal silver">ü•à</span>';
                else if (index === 2) medal = '<span class="medal bronze">ü•â</span>';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1} ${medal}</td>
                    <td>${participant.name}</td>
                    <td>${participant.school}</td>
                    <td>${participant.city}</td>
                    <td>${participant.score || 0}</td>
                    <td>${participant.eventName}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // –ñ–µ“£—ñ–º–ø–∞–∑–¥–∞—Ä —Ç—ñ–∑—ñ–º—ñ–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateWinnersList() {
            const winnersList = document.getElementById('winners-list');
            winnersList.innerHTML = '';
            
            // ”ò—Ä —ñ—Å-—à–∞—Ä–∞–Ω—ã“£ –∂–µ“£—ñ–º–ø–∞–∑–¥–∞—Ä—ã–Ω –∞–ª—É
            const eventsWithParticipants = events.filter(event => 
                participants.some(p => p.eventId === event.id)
            );
            
            if (eventsWithParticipants.length === 0) {
                winnersList.innerHTML = '<p>”ò–ª—ñ –∂–µ“£—ñ–º–ø–∞–∑–¥–∞—Ä –∂–æ“õ.</p>';
                return;
            }
            
            eventsWithParticipants.forEach(event => {
                const eventParticipants = participants.filter(p => p.eventId === event.id);
                if (eventParticipants.length === 0) return;
                
                // “∞–ø–∞–π –±–æ–π—ã–Ω—à–∞ —Å“±—Ä—ã–ø—Ç–∞—É
                const sorted = [...eventParticipants].sort((a, b) => (b.score || 0) - (a.score || 0));
                const top3 = sorted.slice(0, 3);
                
                if (top3.length > 0) {
                    const eventDiv = document.createElement('div');
                    eventDiv.className = 'card';
                    eventDiv.style.marginBottom = '15px';
                    
                    let winnersHTML = `<h4>${event.name}</h4>`;
                    
                    top3.forEach((participant, index) => {
                        let medal = '';
                        if (index === 0) medal = 'ü•á';
                        else if (index === 1) medal = 'ü•à';
                        else if (index === 2) medal = 'ü•â';
                        
                        winnersHTML += `
                            <p>${medal} ${participant.name} (${participant.school}) - ${participant.score || 0} “±–ø–∞–π</p>
                        `;
                    });
                    
                    eventDiv.innerHTML = winnersHTML;
                    winnersList.appendChild(eventDiv);
                }
            });
        }

        // –¢–∞—Ä–∏—Ö —Ç—ñ–∑—ñ–º—ñ–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateHistoryList() {
            const historyList = document.getElementById('history-list');
            historyList.innerHTML = '';
            
            // ”®—Ç–∫–µ–Ω —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã –∞–ª—É
            const pastEvents = events.filter(event => {
                const eventDate = new Date(event.date);
                const today = new Date();
                return eventDate < today;
            });
            
            if (pastEvents.length === 0) {
                historyList.innerHTML = '<p>”®—Ç–∫–µ–Ω —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä –∂–æ“õ.</p>';
                return;
            }
            
            // –ö“Ø–Ω—ñ –±–æ–π—ã–Ω—à–∞ —Å“±—Ä—ã–ø—Ç–∞—É (–µ“£ –∂–∞“õ—ã–Ω)
            const sortedEvents = [...pastEvents].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedEvents.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = 'event';
                eventDiv.style.marginBottom = '15px';
                
                const participantsCount = participants.filter(p => p.eventId === event.id).length;
                
                eventDiv.innerHTML = `
                    <div class="event-header">
                        <h4>${event.name}</h4>
                        <div class="event-date">${formatDate(event.date)}</div>
                    </div>
                    <p>${event.description}</p>
                    <p><i class="fas fa-users"></i> “ö–∞—Ç—ã—Å“õ–∞–Ω–¥–∞—Ä: ${participantsCount} –∞–¥–∞–º</p>
                    <p><i class="fas fa-map-marker-alt"></i> ${event.location}</p>
                `;
                
                historyList.appendChild(eventDiv);
            });
        }

        // –ì—Ä–∞—Ñ–∏–∫—Ç–µ—Ä–¥—ñ –∂–∞“£–∞—Ä—Ç—É
        function updateCharts() {
            // –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä —Ç“Ø—Ä—ñ –±–æ–π—ã–Ω—à–∞ –≥—Ä–∞—Ñ–∏–∫
            const eventsCtx = document.getElementById('eventsChart').getContext('2d');
            
            // –Ü—Å-—à–∞—Ä–∞ —Ç“Ø—Ä–ª–µ—Ä—ñ–Ω —Å–∞–Ω–∞—É
            const eventTypes = {};
            events.forEach(event => {
                eventTypes[event.type] = (eventTypes[event.type] || 0) + 1;
            });
            
            new Chart(eventsCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(eventTypes).map(type => getEventType(type)),
                    datasets: [{
                        data: Object.values(eventTypes),
                        backgroundColor: [
                            '#3498db', '#2ecc71', '#e74c3c', '#9b59b6', '#f1c40f', '#1abc9c'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '–Ü—Å-—à–∞—Ä–∞–ª–∞—Ä–¥—ã“£ —Ç“Ø—Ä–ª–µ—Ä—ñ –±–æ–π—ã–Ω—à–∞ –±”©–ª—ñ–Ω—É—ñ'
                        }
                    }
                }
            });
            
            // “ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä –¥–∏–Ω–∞–º–∏–∫–∞—Å—ã –≥—Ä–∞—Ñ–∏–≥—ñ
            const participantsCtx = document.getElementById('participantsChart').getContext('2d');
            
            // –ê–π–ª–∞—Ä –±–æ–π—ã–Ω—à–∞ “õ–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä–¥—ã —Ç–æ–ø—Ç–∞—É
            const monthlyParticipants = {};
            participants.forEach(p => {
                const date = new Date(p.registeredAt);
                const monthYear = `${date.getFullYear()}-${date.getMonth() + 1}`;
                monthlyParticipants[monthYear] = (monthlyParticipants[monthYear] || 0) + 1;
            });
            
            const months = Object.keys(monthlyParticipants).sort();
            const counts = months.map(month => monthlyParticipants[month]);
            
            new Chart(participantsCtx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: '“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä —Å–∞–Ω—ã',
                        data: counts,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä–¥—ã“£ –¥–∏–Ω–∞–º–∏–∫–∞—Å—ã'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        // –ü–∞—Ä–æ–ª—å–¥—ñ —Ç–µ–∫—Å–µ—Ä—É
        function setupPasswordProtection() {
            // –Ü—Å-—à–∞—Ä–∞ “õ–æ—Å—É —Ñ–æ—Ä–º–∞—Å—ã–Ω—ã“£ –ø–∞—Ä–æ–ª—ñ–Ω —Ç–µ–∫—Å–µ—Ä—É
            document.getElementById('checkPasswordBtn').addEventListener('click', function() {
                const password = document.getElementById('adminPassword').value;
                const submitBtn = document.getElementById('submitEventBtn');
                const incorrectMsg = document.getElementById('incorrectPassword');
                
                if (password === ADMIN_PASSWORD) {
                    submitBtn.disabled = false;
                    incorrectMsg.style.display = 'none';
                    addNotification('”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ø–∞—Ä–æ–ª—ñ “õ–∞–±—ã–ª–¥–∞–Ω–¥—ã', 'success');
                } else {
                    submitBtn.disabled = true;
                    incorrectMsg.style.display = 'block';
                }
            });
            
            // ”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ø–∞–Ω–µ–ª—ñ–Ω–µ –∫—ñ—Ä—É
            document.getElementById('adminAccessBtn').addEventListener('click', function() {
                const password = document.getElementById('adminAccessPassword').value;
                const adminTabs = document.getElementById('adminTabs');
                const incorrectMsg = document.getElementById('adminIncorrectPassword');
                
                if (password === ADMIN_PASSWORD) {
                    isAdminAuthenticated = true;
                    adminTabs.style.display = 'block';
                    incorrectMsg.style.display = 'none';
                    addNotification('”ò–∫—ñ–º—à—ñ–ª—ñ–∫ –ø–∞–Ω–µ–ª—ñ–Ω–µ –∫—ñ—Ä–¥—ñ“£—ñ–∑', 'success');
                    
                    // –ì—Ä–∞—Ñ–∏–∫—Ç–µ—Ä–¥—ñ –±–∞—Å—Ç–∞—É
                    updateCharts();
                } else {
                    incorrectMsg.style.display = 'block';
                }
            });
        }

        // –ñ–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ —Å–∞“õ—Ç–∞—É
        function saveToLocalStorage() {
            try {
                localStorage.setItem('olympiada_events', JSON.stringify(events));
                localStorage.setItem('olympiada_participants', JSON.stringify(participants));
                localStorage.setItem('olympiada_notifications', JSON.stringify(notifications));
            } catch (e) {
                console.log('–ñ–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ —Å–∞“õ—Ç–∞—É “õ–∞—Ç–µ—Å—ñ:', e);
            }
        }

        // –ñ–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ –∂“Ø–∫—Ç–µ—É
        function loadFromLocalStorage() {
            try {
                const savedEvents = localStorage.getItem('olympiada_events');
                const savedParticipants = localStorage.getItem('olympiada_participants');
                const savedNotifications = localStorage.getItem('olympiada_notifications');
                
                if (savedEvents) events = JSON.parse(savedEvents);
                if (savedParticipants) participants = JSON.parse(savedParticipants);
                if (savedNotifications) notifications = JSON.parse(savedNotifications);
            } catch (e) {
                console.log('–ñ–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ –∂“Ø–∫—Ç–µ—É “õ–∞—Ç–µ—Å—ñ:', e);
            }
        }

        // –ü—ñ–∫—ñ—Ä —Ñ–æ—Ä–º–∞—Å—ã
        function setupFeedbackForm() {
            const feedbackForm = document.getElementById('feedbackForm');
            if (feedbackForm) {
                feedbackForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('feedbackName').value;
                    const email = document.getElementById('feedbackEmail').value;
                    const message = document.getElementById('feedbackMessage').value;
                    
                    // –ú“±–Ω–¥–∞ –ø—ñ–∫—ñ—Ä–¥—ñ ”©“£–¥–µ—É “õ–æ—Å—ã–ª–∞–¥—ã (email –∂—ñ–±–µ—Ä—É, –±–∞–∑–∞“ì–∞ —Å–∞“õ—Ç–∞—É, —Ç.–±.)
                    console.log('–ü—ñ–∫—ñ—Ä:', { name, email, message });
                    
                    // –•–∞–±–∞—Ä–ª–∞–º–∞ –∫”©—Ä—Å–µ—Ç—É
                    addNotification('–ü—ñ–∫—ñ—Ä—ñ“£—ñ–∑ —Å”ô—Ç—Ç—ñ –∂—ñ–±–µ—Ä—ñ–ª–¥—ñ! –†–∞—Ö–º–µ—Ç!', 'success');
                    
                    // –§–æ—Ä–º–∞–Ω—ã —Ç–∞–∑–∞–ª–∞—É
                    this.reset();
                    
                    // ”ò–∫—ñ–º—à—ñ–ª—ñ–∫–∫–µ —Ö–∞–±–∞—Ä–ª–∞–º–∞ “õ–æ—Å—É
                    if (isAdminAuthenticated) {
                        addNotification(`–ñ–∞“£–∞ –ø—ñ–∫—ñ—Ä: ${name} - ${message.substring(0, 50)}...`, 'info');
                    }
                });
            }
        }

        // –ë–∞—Ä—ã–Ω—à–∞ –æ“õ—ã–ª“ì–∞–Ω –¥–µ–ø –±–µ–ª–≥—ñ–ª–µ—É
        function setupMarkAllRead() {
            document.getElementById('markAllRead').addEventListener('click', function() {
                notifications.forEach(notif => notif.read = true);
                displayNotifications();
                addNotification('–ë–∞—Ä–ª—ã“õ —Ö–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä –æ“õ—ã–ª“ì–∞–Ω –¥–µ–ø –±–µ–ª–≥—ñ–ª–µ–Ω–¥—ñ', 'success');
            });
        }

        // –¢–µ–ª–µ—Ñ–æ–Ω –Ω”©–º—ñ—Ä—ñ —Ñ–æ—Ä–º–∞—Ç—ã
        function setupPhoneFormat() {
            const phoneInput = document.getElementById('participantPhone');
            if (phoneInput) {
                phoneInput.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    if (value.length > 0) {
                        if (!value.startsWith('7')) {
                            value = '7' + value;
                        }
                        this.value = '+7 (' + value.substring(1, 4) + ') ' + value.substring(4, 7) + '-' + value.substring(7, 9) + '-' + value.substring(9, 11);
                    }
                });
            }
        }

        // –ü–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä–¥—ñ —Å–∞“õ—Ç–∞—É
        function setupSettings() {
            document.getElementById('saveSettings').addEventListener('click', function() {
                const adminEmail = document.getElementById('adminEmail').value;
                const botName = document.getElementById('telegramBotName').value;
                const defaultCapacity = document.getElementById('defaultCapacity').value;
                
                // –ú“±–Ω–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä–¥—ñ —Å–∞“õ—Ç–∞—É “õ–æ—Å—ã–ª–∞–¥—ã
                localStorage.setItem('admin_email', adminEmail);
                localStorage.setItem('telegram_bot', botName);
                localStorage.setItem('default_capacity', defaultCapacity);
                
                addNotification('–ü–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä —Å”ô—Ç—Ç—ñ —Å–∞“õ—Ç–∞–ª–¥—ã', 'success');
            });
            
            // –°–∞“õ—Ç–∞–ª“ì–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–ª–µ—Ä–¥—ñ –∂“Ø–∫—Ç–µ—É
            const savedEmail = localStorage.getItem('admin_email');
            const savedBot = localStorage.getItem('telegram_bot');
            const savedCapacity = localStorage.getItem('default_capacity');
            
            if (savedEmail) document.getElementById('adminEmail').value = savedEmail;
            if (savedBot) document.getElementById('telegramBotName').value = savedBot;
            if (savedCapacity) document.getElementById('defaultCapacity').value = savedCapacity;
        }

        // –ù–µ–≥—ñ–∑–≥—ñ –±–∞—Å—Ç–∞–ø“õ—ã —Ñ—É–Ω–∫—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –ñ–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂“Ø–∫—Ç–µ—É
            loadFromLocalStorage();
            
            // –î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∫”©—Ä—Å–µ—Ç—É
            displayEvents();
            displayParticipants();
            displayAdminEvents();
            displayNotifications();
            updateRankingTable();
            updateWinnersList();
            updateHistoryList();
            
            // –§—É–Ω–∫—Ü–∏—è–ª–∞—Ä–¥—ã —ñ—Å–∫–µ “õ–æ—Å—É
            setupFilters();
            setupSorting();
            setupDarkMode();
            setupExport();
            setupNavigation();
            setupTelegramBot();
            setupTabs();
            setupPasswordProtection();
            setupFeedbackForm();
            setupMarkAllRead();
            setupPhoneFormat();
            setupSettings();
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–Ω—ã –∂–∞“£–∞—Ä—Ç—É
            updateLiveParticipants();
            setInterval(updateLiveParticipants, 30000);
            
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            
            updateCurrentYear();
            
            // –§–æ—Ä–º–∞–ª–∞—Ä–¥—ã –±–∞—Å“õ–∞—Ä—É
            const toggleFormBtn = document.getElementById('toggleFormBtn');
            const eventForm = document.getElementById('eventForm');
            
            if (toggleFormBtn && eventForm) {
                toggleFormBtn.addEventListener('click', function() {
                    eventForm.style.display = eventForm.style.display === 'block' ? 'none' : 'block';
                });
            }
            
            // –ñ–∞“£–∞ —ñ—Å-—à–∞—Ä–∞ —Ñ–æ—Ä–º–∞—Å—ã
            const newEventForm = document.getElementById('newEventForm');
            if (newEventForm) {
                newEventForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    if (document.getElementById('submitEventBtn').disabled) {
                        alert('–ê–ª–¥—ã–º–µ–Ω –ø–∞—Ä–æ–ª—å–¥—ñ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑!');
                        return;
                    }
                    
                    const eventData = {
                        name: document.getElementById('eventName').value,
                        date: document.getElementById('eventDate').value,
                        location: document.getElementById('eventLocation').value,
                        type: document.getElementById('eventType').value,
                        description: document.getElementById('eventDescription').value,
                        image: document.getElementById('eventImage').value || 'https://images.unsplash.com/photo-1546410531-bb4caa6b424d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                        capacity: parseInt(document.getElementById('eventCapacity').value) || 
                                 parseInt(document.getElementById('defaultCapacity').value) || 100
                    };
                    
                    const eventId = addNewEvent(eventData);
                    
                    // –§–æ—Ä–º–∞–Ω—ã —Ç–∞–∑–∞–ª–∞—É
                    this.reset();
                    
                    // –°”ô—Ç—Ç—ñ–ª—ñ–∫ —Ö–∞–±–∞—Ä–ª–∞–º–∞—Å—ã–Ω –∫”©—Ä—Å–µ—Ç—É
                    const successMessage = document.getElementById('successMessage');
                    successMessage.style.display = 'block';
                    setTimeout(() => {
                        successMessage.style.display = 'none';
                    }, 3000);
                    
                    // –ü–∞—Ä–æ–ª—å–¥—ñ “õ–∞–π—Ç–∞ –±–µ–ª–≥—ñ–ª–µ—É
                    document.getElementById('submitEventBtn').disabled = true;
                });
            }
            
            // –¢—ñ—Ä–∫–µ–ª—É —Ñ–æ—Ä–º–∞—Å—ã
            const registrationForm = document.getElementById('registrationForm');
            if (registrationForm) {
                registrationForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const eventId = parseInt(document.getElementById('eventIdForRegistration').value);
                    const event = events.find(e => e.id === eventId);
                    
                    // –°—ã–π—ã–º–¥—ã–ª—ã“õ—Ç—ã —Ç–µ–∫—Å–µ—Ä—É
                    if (event && event.capacity && event.participants >= event.capacity) {
                        alert('–ö–µ—à—ñ—Ä—ñ“£—ñ–∑, –±“±–ª —ñ—Å-—à–∞—Ä–∞“ì–∞ –±–∞—Ä–ª—ã“õ –æ—Ä—ã–Ω–¥–∞—Ä —Ç–æ–ª–¥—ã! –ë–∞—Å“õ–∞ —ñ—Å-—à–∞—Ä–∞–Ω—ã —Ç–∞“£–¥–∞“£—ã–∑.');
                        return;
                    }
                    
                    const newParticipant = {
                        id: participants.length > 0 ? Math.max(...participants.map(p => p.id)) + 1 : 1,
                        name: document.getElementById('participantName').value,
                        email: document.getElementById('participantEmail').value,
                        phone: document.getElementById('participantPhone').value,
                        school: document.getElementById('participantSchool').value,
                        class: document.getElementById('participantClass').value,
                        city: document.getElementById('participantCity').value,
                        eventId: eventId,
                        eventName: event ? event.name : '–ë–µ–ª–≥—ñ—Å—ñ–∑ —ñ—Å-—à–∞—Ä–∞',
                        registeredAt: new Date().toISOString().split('T')[0],
                        score: Math.floor(Math.random() * 30) + 70 // –ö–µ–∑–¥–µ–π—Å–æ“õ “±–ø–∞–π
                    };
                    
                    participants.push(newParticipant);
                    
                    // –Ü—Å-—à–∞—Ä–∞ “õ–∞—Ç—ã—Å—É—à—ã —Å–∞–Ω—ã–Ω –∂–∞“£–∞—Ä—Ç—É
                    if (event) {
                        event.participants++;
                    }
                    
                    // –î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂–∞“£–∞—Ä—Ç—É
                    displayEvents();
                    displayParticipants();
                    displayAdminEvents();
                    updateStats();
                    updateRankingTable();
                    updateWinnersList();
                    
                    // –§–æ—Ä–º–∞–Ω—ã —Ç–∞–∑–∞–ª–∞—É
                    this.reset();
                    
                    // –°”ô—Ç—Ç—ñ–ª—ñ–∫ —Ö–∞–±–∞—Ä–ª–∞–º–∞—Å—ã–Ω –∫”©—Ä—Å–µ—Ç—É
                    const successMessage = document.getElementById('registrationSuccess');
                    successMessage.style.display = 'block';
                    
                    // –ú–æ–¥–∞–ª—å–¥—ã —Ç–µ—Ä–µ–∑–µ–Ω—ñ –∂–∞–±—É
                    setTimeout(() => {
                        successMessage.style.display = 'none';
                        document.getElementById('registrationModal').style.display = 'none';
                    }, 3000);
                    
                    addNotification(`–ñ–∞“£–∞ “õ–∞—Ç—ã—Å—É—à—ã —Ç—ñ—Ä–∫–µ–ª–¥—ñ: ${newParticipant.name}`, 'success');
                    
                    // –ñ–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ —Å–∞“õ—Ç–∞—É
                    saveToLocalStorage();
                });
            }
            
            // –•–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä –º–æ–¥–∞–ª—å–¥—ã —Ç–µ—Ä–µ–∑–µ—Å—ñ
            const notificationBtn = document.getElementById('notification-btn');
            const notificationModal = document.getElementById('notificationModal');
            
            if (notificationBtn && notificationModal) {
                notificationBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    notificationModal.style.display = 'block';
                });
                
                // –ú–æ–¥–∞–ª—å–¥—ã —Ç–µ—Ä–µ–∑–µ–Ω—ñ –∂–∞–±—É
                notificationModal.querySelector('.close-btn').onclick = () => {
                    notificationModal.style.display = 'none';
                };
                
                window.onclick = (event) => {
                    if (event.target === notificationModal) {
                        notificationModal.style.display = 'none';
                    }
                };
            }
            
            // –°—É—Ä–µ—Ç—Ç–µ—Ä –∂“Ø–∫—Ç–µ–ª–º–µ–≥–µ–Ω –∂–∞“ì–¥–∞–π–¥–∞ “õ–æ–ª–¥–∞—É –∫”©—Ä—Å–µ—Ç–∫—ñ—à—ñ
            document.addEventListener('error', function(e) {
                if (e.target.tagName === 'IMG') {
                    e.target.src = 'https://images.unsplash.com/photo-1546410531-bb4caa6b424d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80';
                }
            }, true);
            
            // –ö–µ–∑–¥–µ–π—Å–æ“õ –∂–∞“£–∞—Ä—Ç—É–ª–∞—Ä —ç–º—É–ª—è—Ü–∏—è—Å—ã
            setInterval(() => {
                if (events.length > 0 && Math.random() > 0.7) {
                    const randomEvent = events[Math.floor(Math.random() * events.length)];
                    randomEvent.participants += Math.floor(Math.random() * 3);
                    displayEvents();
                    updateStats();
                    
                    if (randomEvent.participants >= randomEvent.capacity * 0.9) {
                        addNotification(`"${randomEvent.name}" —ñ—Å-—à–∞—Ä–∞—Å—ã–Ω–∞ –æ—Ä—ã–Ω–¥–∞—Ä —Ç–∞—É—Å—ã–ª—ã–ø –∂–∞—Ç—ã—Ä!`, 'urgent');
                    }
                }
            }, 60000); // 1 –º–∏–Ω—É—Ç —Å–∞–π—ã–Ω
        });
    </script>
</body>
</html>
